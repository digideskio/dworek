extends page

block content
    .nd2-card.wow.fadeInUp
        .card-title.has-supporting-text
            h3.card-primary-title Application status

        .card-supporting-text.has-action.has-title
            p The cards below show the current status of the #{app.name} servers and sub-systems.

    .nd2-card.wow.fadeInUp
        .card-title.has-supporting-text
            h3.card-primary-title Session

        .card-supporting-text.has-action.has-title
            p Status of your current session.
            table.table-list.ui-responsive
                tr: td Logged in
                    td
                        if session.valid
                            span(style='color: green;') Yes
                        else
                            | No
                if session.valid
                    tr: td Name
                        td: i= session.user.firstName

    .nd2-card.wow.fadeInUp
        .card-title.has-supporting-text
            h3.card-primary-title Server Status

        .card-supporting-text.has-action.has-title
            p Status of the resources available to #{app.name} on the machine the server is running on.
            table.table-list.ui-responsive
                tr: td OS
                    td: span.status-server-os= status.server.os
                        span(style="color: gray;")  (#{status.server.platform}/#{status.server.arch})
                tr: td CPUs
                    td: span.status-server-cpus= status.server.cpus.length
                        span(style="color: gray;")  cores
                tr: td Model
                    td: small: small.status-server-model= status.server.cpus[0].model
                tr: td Memory
                    td: span.status-server-memory-total= status.server.memory.total
                        span(style="color: gray;")  total
                tr: td
                    td: span.status-server-memory-used= status.server.memory.used
                        span(style="color: gray;")  used
                tr: td
                    td: span.status-server-memory-free= status.server.memory.free
                        span(style="color: gray;")  free
                tr: td Load
                    td: span.status-server-load-1= status.server.loadavg[0]
                        span(style="color: gray;")  avg last minute
                tr: td
                    td: span.status-server-load-5= status.server.loadavg[1]
                        span(style="color: gray;")  avg last 5 minutes
                tr: td
                    td: span.status-server-load-15= status.server.loadavg[2]
                        span(style="color: gray;")  avg last 15 minutes
                tr: td Latency
                    td: span(style="color: gray;") Recent response times:
                tr: td
                    td: span.status-server-latency-max= status.server.latency[0]
                        span(style="color: gray;")  max
                tr: td
                    td: span.status-server-latency-min= status.server.latency[1]
                        span(style="color: gray;")  min
                tr: td
                    td: span.status-server-latency-50= status.server.latency[2]
                        span(style="color: gray;")  50%-th
                tr: td
                    td: span.status-server-latency-90= status.server.latency[3]
                        span(style="color: gray;")  90%-th
                tr: td
                    td: span.status-server-latency-99= status.server.latency[4]
                        span(style="color: gray;")  99%-th

    .nd2-card.wow.fadeInUp
        .card-title.has-supporting-text
            h3.card-primary-title Game Logic

        .card-supporting-text.has-action.has-title
            p Status of the sub-system processing the logic for all active games.
            table.table-list.ui-responsive
                tr: td Status
                    td
                        if status.live.gameCount > 0
                            span(style='color: green;') Working
                        else
                            span Idle
                tr: td Active games
                    td: span.activeGameCount= status.live.gameCount

    .nd2-card.wow.fadeInUp
        .card-title.has-supporting-text
            h3.card-primary-title Real-time

        .card-supporting-text.has-action.has-title
            p Status of the server handling all real-time connections to clients.
            table.table-list.ui-responsive
                tr: td Status
                    td
                        if status.realtime.online
                            span(style='color: green;') Online
                        else
                            span(style='color: red;') Offline
                tr: td Connected clients
                    td= status.realtime.connections

    .nd2-card.wow.fadeInUp
        .card-title.has-supporting-text
            h3.card-primary-title Web Server

        .card-supporting-text.has-action.has-title
            p Status of the web server providing you this front-end.
            table.table-list.ui-responsive
                tr: td Status
                    td: span(style='color: green;') Online
                tr: td Uptime
                    td #{status.web.uptime} seconds

    .nd2-card.wow.fadeInUp
        .card-title.has-supporting-text
            h3.card-primary-title Database

        .card-supporting-text.has-action.has-title
            p Status of the database server.
            table.table-list.ui-responsive
                tr: td Status
                    td
                        if status.mongo.online
                            span(style='color: green;') Online
                        else
                            span(style='color: red;') Offline

    .nd2-card.wow.fadeInUp
        .card-title.has-supporting-text
            h3.card-primary-title Cache

        .card-supporting-text.has-action.has-title
            p Status of the in-memory caching server.
            table.table-list.ui-responsive
                tr: td Status
                    td
                        if status.redis.online
                            span(style='color: green;') Online
                        else
                            span(style='color: red;') Offline
                if status.redis.online
                    tr: td Uptime
                        td #{status.redis.uptime} seconds
                    tr: td Queries processed
                        td= status.redis.commandCount
                    tr: td Cached fields
                        td= status.redis.keyCount
                    tr: td Used memory
                        td= status.redis.memory

    .nd2-card.wow.fadeInUp
        .card-title.has-supporting-text
            h3.card-primary-title Internal Cache

        .card-supporting-text.has-action.has-title
            p Status of the high-performance internal caching sub-system.
            table.table-list.ui-responsive
                tr: td Cached objects
                    td= status.cache.objectCount
                tr: td Cached fields
                    td #{status.cache.fieldCount}
